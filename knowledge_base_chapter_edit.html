<p>
  <script>
    /*
  This script modifies the Moodle Book Table of Contents block.
  It performs the following actions on DOM load:
  1. Removes the 'text-truncate' class to show full chapter names.
  2. Increases the width of the ToC block by 60%.
  3. Scales down the font size for text and icons by a factor of 0.7.
  4. Fixes list item vertical spacing by adjusting line height.
  5. Fixes icon alignment and padding issues (especially for the trash icon).
  6. Reduces the large margin between chapter titles and the action icons.
*/
    document.addEventListener("DOMContentLoaded", function() {

      // --- 1. Show full chapter names ---

      const chapterLinks = document.querySelectorAll(
        ".block_book_toc a.text-truncate");
      chapterLinks.forEach(function(link) {
        link.classList.remove("text-truncate");
      });


      // --- 2. Make the section 60% wider ---

      const tocSection = document.querySelector(".block_book_toc");

      if (tocSection) {
        const currentWidth = tocSection.offsetWidth;
        const newWidth = currentWidth * 1.6; // Use 1.6 for +60%
        tocSection.style.width = newWidth + "px";
      }


      // --- 3. Decrease text font size by 30% (to 70%) ---

      const contentArea = document.querySelector(
        ".block_book_toc .card-text");

      if (contentArea) {
        const currentFontSize = window.getComputedStyle(contentArea)
          .fontSize;
        const currentSizeValue = parseFloat(currentFontSize);
        const newTextSize = currentSizeValue * 0.7; // Use 0.7 factor

        // Apply new font size
        contentArea.style.fontSize = newTextSize + "px";

        // --- 4. Fix vertical height of list items ---

        contentArea.style.lineHeight = "1.2";


        // --- 5. Handle icon downscaling (to 70%) ---

        const icons = contentArea.querySelectorAll(".icon");
        // Calculate the new icon size based on the *new text size*
        const newIconSize = newTextSize * 0.7;

        icons.forEach(function(icon) {
          // Force all icons to the same calculated size
          icon.style.fontSize = newIconSize + "px";
        });


        // --- 6. Fix trash can icon size and alignment ---

        const actionLinks = contentArea.querySelectorAll(".action-list a");
        actionLinks.forEach(function(link) {
          link.style.verticalAlign = "middle";
        });

        const trashIconLinks = contentArea.querySelectorAll(
          "a.action-icon.p-1");
        trashIconLinks.forEach(function(link) {
          link.classList.remove("p-1");
          link.style.padding = "0";
        });

        // --- 7. Reduce margin between title and icons ---

        const actionLists = contentArea.querySelectorAll(
          ".action-list.ms-auto");
        actionLists.forEach(function(list) {
          // Remove the class that pushes it all the way to the right
          list.classList.remove("ms-auto");
          // Add a smaller, fixed margin
          list.classList.add("ms-2");
        });
      }

    });
  </script>
</p>